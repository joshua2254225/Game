<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Geometry Dash â€“ ArcadeOwl</title>

<style>
html,body{
  margin:0;
  background:#000;
  overflow:hidden;
  font-family:system-ui,Arial;
}
canvas{
  display:block;
  margin:auto;
}
#hud{
  position:fixed;
  top:8px;
  left:50%;
  transform:translateX(-50%);
  width:92%;
  max-width:1000px;
  color:#fff;
}
#top{
  display:flex;
  justify-content:space-between;
  font-weight:700;
}
#bar{
  height:8px;
  background:#222;
  border-radius:6px;
  overflow:hidden;
  margin-top:6px;
}
#barFill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#00f6ff,#ff00cc);
}
</style>
</head>

<body>

<div id="hud">
  <div id="top">
    <div>Score: <span id="score">0</span></div>
    <div>Best: <span id="best">0</span></div>
  </div>
  <div id="bar"><div id="barFill"></div></div>
</div>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize",resize);

let score = 0;
let best = localStorage.getItem("gdBest") || 0;
document.getElementById("best").textContent = best;

const player = {
  x: 140,
  y: 0,
  size: 36,
  vy: 0
};

let groundY;
let mode = "cube";
let holding = false;
let gameOver = false;
let frame = 0;

const GRAVITY = 0.9;
const JUMP = -12;

let obstacles = [];
let nextSpawn = 160;

function reset(){
  score = 0;
  frame = 0;
  mode = "cube";
  obstacles = [];
  player.vy = 0;
  groundY = canvas.height - 100;
  player.y = groundY - player.size;
  gameOver = false;
}
reset();

function spawnObstacle(){
  const type = Math.random()<0.5 ? "block" : "spike";
  obstacles.push({
    x: canvas.width + 80,
    w: type==="block"?50:40,
    h: type==="block"?60:50,
    type
  });
  nextSpawn = frame + 140 + Math.random()*80; // Abstand!
}

function update(){
  if(gameOver) return;

  frame++;
  score++;
  document.getElementById("score").textContent = score;
  document.getElementById("barFill").style.width = Math.min(score/3000*100,100)+"%";

  // MODE SWITCH
  if(score===1800) mode="ship";

  // SPAWN
  if(frame>nextSpawn) spawnObstacle();

  // PHYSICS
  if(mode==="cube"){
    player.vy += GRAVITY;
    if(holding && player.vy<0) player.vy -= 0.15;
  }else{
    player.vy += holding?-0.6:0.6;
  }
  player.y += player.vy;

  if(player.y+player.size>groundY){
    player.y=groundY-player.size;
    player.vy=0;
  }

  // OBSTACLES
  obstacles.forEach(o=>o.x-=6);
  obstacles = obstacles.filter(o=>o.x+o.w>0);

  // COLLISION
  for(const o of obstacles){
    if(player.x<o.x+o.w &&
       player.x+player.size>o.x &&
       player.y+player.size>groundY-o.h){
      endGame();
    }
  }
}

function endGame(){
  gameOver=true;
  if(score>best){
    best=score;
    localStorage.setItem("gdBest",best);
    document.getElementById("best").textContent=best;
  }
  setTimeout(reset,1400);
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // BACKGROUND
  ctx.fillStyle=`hsl(${score/10%360},60%,8%)`;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // GROUND
  ctx.fillStyle="#222";
  ctx.fillRect(0,groundY,canvas.width,100);

  // PLAYER
  ctx.save();
  ctx.translate(player.x+player.size/2,player.y+player.size/2);
  if(mode==="cube") ctx.rotate(frame*0.05);
  ctx.fillStyle=mode==="cube"?"#00f6ff":"#ff00cc";
  ctx.shadowColor=ctx.fillStyle;
  ctx.shadowBlur=20;
  ctx.fillRect(-player.size/2,-player.size/2,player.size,player.size);
  ctx.restore();

  // OBSTACLES
  ctx.fillStyle="#ff0033";
  obstacles.forEach(o=>{
    ctx.fillRect(o.x,groundY-o.h,o.w,o.h);
  });
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();

// INPUT
addEventListener("keydown",e=>{if(e.code==="Space")holding=true});
addEventListener("keyup",e=>{if(e.code==="Space")holding=false});
canvas.addEventListener("touchstart",()=>holding=true);
canvas.addEventListener("touchend",()=>holding=false);
</script>

</body>
</html>
