<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Geometry Dash – ArcadeOwl</title>

<style>
html,body{
  margin:0;
  background:#000;
  overflow:hidden;
  font-family:system-ui,Arial;
}
canvas{
  display:block;
  margin:auto;
}
#hud{
  position:fixed;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  width:90%;
  max-width:900px;
  color:#fff;
  z-index:10;
}
#top{
  display:flex;
  justify-content:space-between;
  font-weight:700;
}
#bar{
  height:8px;
  background:#222;
  border-radius:6px;
  overflow:hidden;
  margin-top:6px;
}
#barFill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#00f6ff,#ff00cc);
}
#startBtn{
  position:fixed;
  bottom:30px;
  left:50%;
  transform:translateX(-50%);
  padding:14px 28px;
  font-size:18px;
  font-weight:700;
  border:none;
  border-radius:10px;
  background:#00f6ff;
  color:#000;
  cursor:pointer;
}
</style>
</head>

<body>

<div id="hud">
  <div id="top">
    <div>Score: <span id="score">0</span></div>
    <div>Best: <span id="best">0</span></div>
  </div>
  <div id="bar"><div id="barFill"></div></div>
</div>

<button id="startBtn">▶ Start</button>

<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize",resize);

const scoreEl = document.getElementById("score");
const bestEl = document.getElementById("best");
const barFill = document.getElementById("barFill");
const startBtn = document.getElementById("startBtn");

let best = localStorage.getItem("gdBest") || 0;
bestEl.textContent = best;

let running = false;
let holding = false;
let score = 0;
let frame = 0;

const player = {
  x: 140,
  y: 0,
  size: 36,
  vy: 0,
  onGround: false
};

let groundY;
let obstacles = [];
let nextSpawn = 0;

const GRAVITY = 0.8;
const JUMP = -14;
const SPEED = 6;

function reset(){
  score = 0;
  frame = 0;
  obstacles = [];
  groundY = canvas.height - 100;
  player.y = groundY - player.size;
  player.vy = 0;
  player.onGround = true;
  nextSpawn = 120;
  scoreEl.textContent = 0;
  barFill.style.width = "0%";
}

function startGame(){
  reset();
  running = true;
  startBtn.style.display = "none";
}

function spawnObstacle(){
  obstacles.push({
    x: canvas.width + 60,
    w: 50,
    h: 60
  });
  nextSpawn = frame + 140 + Math.random()*120;
}

function update(){
  if(!running) return;

  frame++;
  score++;
  scoreEl.textContent = score;
  barFill.style.width = Math.min(score/3000*100,100)+"%";

  // spawn
  if(frame > nextSpawn){
    spawnObstacle();
  }

  // jump logic (FIXED)
  if(holding && player.onGround){
    player.vy = JUMP;
    player.onGround = false;
  }

  // physics
  player.vy += GRAVITY;
  player.y += player.vy;

  if(player.y + player.size >= groundY){
    player.y = groundY - player.size;
    player.vy = 0;
    player.onGround = true;
  }

  // obstacles
  obstacles.forEach(o=>o.x -= SPEED);
  obstacles = obstacles.filter(o=>o.x + o.w > 0);

  // collision
  for(const o of obstacles){
    if(player.x < o.x+o.w &&
       player.x+player.size > o.x &&
       player.y+player.size > groundY-o.h){
      endGame();
    }
  }
}

function endGame(){
  running = false;
  startBtn.style.display = "block";
  startBtn.textContent = "↻ Restart";

  if(score > best){
    best = score;
    localStorage.setItem("gdBest",best);
    bestEl.textContent = best;
  }
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // background
  ctx.fillStyle=`hsl(${score/10%360},60%,8%)`;
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // ground
  ctx.fillStyle="#222";
  ctx.fillRect(0,groundY,canvas.width,100);

  // player
  ctx.save();
  ctx.translate(player.x+player.size/2,player.y+player.size/2);
  ctx.rotate(frame*0.05);
  ctx.fillStyle="#00f6ff";
  ctx.shadowColor="#00f6ff";
  ctx.shadowBlur=20;
  ctx.fillRect(-player.size/2,-player.size/2,player.size,player.size);
  ctx.restore();

  // obstacles
  ctx.fillStyle="#ff0033";
  obstacles.forEach(o=>{
    ctx.fillRect(o.x,groundY-o.h,o.w,o.h);
  });
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();

// input
addEventListener("keydown",e=>{
  if(e.code==="Space") holding=true;
});
addEventListener("keyup",e=>{
  if(e.code==="Space") holding=false;
});
canvas.addEventListener("touchstart",()=>holding=true);
canvas.addEventListener("touchend",()=>holding=false);

startBtn.addEventListener("click",startGame);
</script>

</body>
</html>
