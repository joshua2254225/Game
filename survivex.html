<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SurviveX â€“ Tunnel</title>

<style>
body{
  margin:0;
  background:black;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
  font-family:Arial, sans-serif;
}

/* GAME VIEW */
#game{
  width:360px;
  height:600px;
  position:relative;
  perspective:800px;
  overflow:hidden;
  background:black;
}

/* TUNNEL */
#tunnel{
  position:absolute;
  width:100%;
  height:120%;
  transform-style:preserve-3d;
  animation: tunnelMove 1.2s linear infinite;
}

/* Tunnel segments */
.segment{
  position:absolute;
  left:50%;
  transform:translateX(-50%);
  border:2px solid #1e293b;
  box-sizing:border-box;
}

/* PLAYER */
#player{
  width:26px;
  height:26px;
  background:#22c55e;
  position:absolute;
  bottom:60px;
  left:167px;
  z-index:5;
  border-radius:6px;
}

/* ENEMY */
.enemy{
  position:absolute;
  background:#ef4444;
  border-radius:6px;
}

/* UI */
#ui{
  position:absolute;
  top:10px;
  left:10px;
  color:white;
  z-index:10;
  font-size:14px;
}

/* MESSAGE */
#message{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.8);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  color:white;
  z-index:20;
}

button{
  padding:10px 20px;
  border:none;
  background:#2563eb;
  color:white;
  border-radius:8px;
  cursor:pointer;
}

/* Tunnel movement */
@keyframes tunnelMove{
  from{ transform: rotateX(55deg) translateY(-200px); }
  to{ transform: rotateX(55deg) translateY(0); }
}
</style>
</head>

<body>

<div id="game">
  <div id="ui">Kills: <span id="kills">0</span></div>

  <div id="tunnel"></div>

  <div id="player"></div>

  <div id="message">
    <h2>SurviveX</h2>
    <button onclick="start()">Start</button>
  </div>
</div>

<script>
const tunnel = document.getElementById("tunnel");
const player = document.getElementById("player");
const killsEl = document.getElementById("kills");
const msg = document.getElementById("message");

let enemies = [];
let running = false;
let kills = 0;
let playerX = 167;

// ---------- BUILD TUNNEL ----------
for(let i=0;i<20;i++){
  const s = document.createElement("div");
  s.className="segment";
  s.style.top = (-i*80)+"px";
  const scale = 1 - i*0.035;
  s.style.width = 260*scale+"px";
  s.style.height = 60*scale+"px";
  tunnel.appendChild(s);
}

// ---------- START ----------
function start(){
  enemies.forEach(e=>e.el.remove());
  enemies=[];
  kills=0;
  killsEl.textContent=0;
  msg.style.display="none";
  running=true;
}

// ---------- PLAYER ----------
document.addEventListener("keydown",e=>{
  if(!running) return;
  if(e.key==="ArrowLeft") playerX-=20;
  if(e.key==="ArrowRight") playerX+=20;
  playerX=Math.max(90,Math.min(250,playerX));
  player.style.left=playerX+"px";
});

// ---------- SPAWN ENEMY ----------
setInterval(()=>{
  if(!running) return;

  const e=document.createElement("div");
  e.className="enemy";
  e.style.left=(Math.random()*200+80)+"px";
  tunnel.appendChild(e);

  enemies.push({el:e,z:0});
},1200);

// ---------- GAME LOOP ----------
setInterval(()=>{
  if(!running) return;

  enemies.forEach((o,i)=>{
    o.z+=0.025;
    const size=20+o.z*60;

    o.el.style.width=size+"px";
    o.el.style.height=size+"px";
    o.el.style.top=(200+o.z*320)+"px";

    // collision
    if(o.z>0.9){
      if(Math.abs(o.el.offsetLeft-playerX)<30){
        end();
      }else{
        o.el.remove();
        enemies.splice(i,1);
        kills++;
        killsEl.textContent=kills;
      }
    }
  });
},16);

// ---------- END ----------
function end(){
  running=false;
  msg.style.display="flex";
}
</script>

</body>
</html>
