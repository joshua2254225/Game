<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SurviveX â€“ Tunnel Defense</title>

<style>
body{
  margin:0;
  background:#020617;
  font-family:Arial, sans-serif;
  color:white;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

/* TUNNEL */
#game{
  width:360px;
  height:560px;
  background:linear-gradient(#020617,#020617);
  border:4px solid #2563eb;
  position:relative;
  overflow:hidden;
}

/* Tunnel walls */
#game::before,
#game::after{
  content:"";
  position:absolute;
  top:0;
  width:40px;
  height:100%;
  background:#020617;
  border-left:3px solid #334155;
  border-right:3px solid #334155;
}
#game::before{ left:0; }
#game::after{ right:0; }

/* PLAYER */
#player{
  width:34px;
  height:34px;
  background:#22c55e;
  position:absolute;
  bottom:20px;
  left:163px;
  border-radius:6px;
}

/* ENEMY */
.enemy{
  width:32px;
  height:32px;
  background:#ef4444;
  position:absolute;
  top:-40px;
  border-radius:6px;
}

/* BULLET */
.bullet{
  width:6px;
  height:14px;
  background:#fde047;
  position:absolute;
  border-radius:4px;
}

/* UI */
#ui{
  position:absolute;
  top:8px;
  left:8px;
  font-size:13px;
}

/* MESSAGE */
#message{
  position:absolute;
  inset:0;
  background:rgba(0,0,0,.8);
  display:flex;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  font-size:22px;
  gap:12px;
}

button{
  padding:10px 18px;
  border:none;
  background:#2563eb;
  color:white;
  border-radius:8px;
  cursor:pointer;
}
</style>
</head>

<body>

<div id="game">
  <div id="ui">
    Day: <span id="day">1</span><br>
    Kills: <span id="kills">0</span>
  </div>

  <div id="player"></div>

  <div id="message">
    <div id="msgText">Survive the Tunnel</div>
    <button onclick="startGame()">Start</button>
  </div>
</div>

<script>
const game = document.getElementById("game");
const player = document.getElementById("player");
const dayEl = document.getElementById("day");
const killsEl = document.getElementById("kills");
const message = document.getElementById("message");
const msgText = document.getElementById("msgText");

let playerX = 163;
let enemies = [];
let bullets = [];
let running = false;

let day = 1;
let kills = 0;
let enemySpeed = 1.4;
let spawnRate = 1500;

// ---------------- START ----------------
function startGame(){
  enemies.forEach(e=>e.remove());
  bullets.forEach(b=>b.remove());
  enemies = [];
  bullets = [];

  day = 1;
  kills = 0;
  enemySpeed = 1.4;
  spawnRate = 1500;

  updateUI();
  message.style.display = "none";
  running = true;
}

// ---------------- UI ----------------
function updateUI(){
  dayEl.textContent = day;
  killsEl.textContent = kills;
}

// ---------------- PLAYER MOVE ----------------
document.addEventListener("keydown", e=>{
  if(!running) return;

  if(e.key === "ArrowLeft") playerX -= 18;
  if(e.key === "ArrowRight") playerX += 18;
  if(e.key === " ") shoot();

  playerX = Math.max(40, Math.min(286, playerX));
  player.style.left = playerX + "px";
});

// Mobile shoot
game.addEventListener("click", ()=> running && shoot());

// ---------------- SHOOT ----------------
function shoot(){
  const b = document.createElement("div");
  b.className = "bullet";
  b.style.left = (playerX + 14) + "px";
  b.style.top = "480px";
  game.appendChild(b);
  bullets.push(b);
}

// ---------------- SPAWN ENEMY ----------------
setInterval(()=>{
  if(!running) return;

  const e = document.createElement("div");
  e.className = "enemy";
  e.style.left = (40 + Math.random()*246) + "px";
  game.appendChild(e);
  enemies.push(e);
}, spawnRate);

// ---------------- GAME LOOP ----------------
setInterval(()=>{
  if(!running) return;

  // Move bullets
  bullets.forEach((b, bi)=>{
    b.style.top = (b.offsetTop - 8) + "px";
    if(b.offsetTop < -20){
      b.remove();
      bullets.splice(bi,1);
    }
  });

  // Move enemies
  enemies.forEach((e, ei)=>{
    e.style.top = (e.offsetTop + enemySpeed) + "px";

    // Collision with player
    if(e.offsetTop > 460){
      endGame();
    }

    // Bullet collision
    bullets.forEach((b, bi)=>{
      if(
        b.offsetTop <= e.offsetTop + 32 &&
        b.offsetLeft + 6 >= e.offsetLeft &&
        b.offsetLeft <= e.offsetLeft + 32
      ){
        e.remove();
        b.remove();
        enemies.splice(ei,1);
        bullets.splice(bi,1);
        kill();
      }
    });
  });
},16);

// ---------------- KILL ----------------
function kill(){
  kills++;
  killsEl.textContent = kills;

  if(kills % 10 === 0){
    day++;
    enemySpeed += 0.4;
    spawnRate = Math.max(600, spawnRate - 150);
    updateUI();
  }
}

// ---------------- END ----------------
function endGame(){
  running = false;
  message.style.display = "flex";
  msgText.textContent = "ðŸ’€ You died in the tunnel";
}
</script>

</body>
  </html>
