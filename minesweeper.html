<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Minesweeper ‚Äì ArcadeOwl</title>

<style>
body{
  margin:0;
  font-family:system-ui,Arial;
  background:#f5f7fb;
}
.topbar{
  background:#0b74de;
  color:#fff;
  height:56px;
  display:flex;
  align-items:center;
  justify-content:center;
  position:relative;
  font-weight:800;
}
.home{
  position:absolute;
  left:12px;
  color:white;
  text-decoration:none;
  font-size:20px;
  opacity:.7;
}
.wrap{
  max-width:900px;
  margin:20px auto;
  padding:10px;
  text-align:center;
}
.controls{
  margin-bottom:10px;
}
select,button{
  padding:6px 10px;
  font-size:14px;
  margin:4px;
}
.info{
  margin:8px;
  font-weight:600;
}
.board{
  display:grid;
  margin:0 auto;
  touch-action:manipulation;
}
.cell{
  width:36px;
  height:36px;
  border:1px solid #aaa;
  background:#ddd;
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:800;
  user-select:none;
}
.cell.open{ background:#f0f0f0; }
.cell.flag{ background:#ffd166; }
.cell.bomb{ background:#ff595e; color:#fff; }
</style>
</head>

<body>

<header class="topbar">
  <a class="home" href="index.html">‚Üê</a>
  Minesweeper
</header>

<main class="wrap">

<div class="controls">
  <select id="level">
    <option value="easy">Easy</option>
    <option value="medium">Medium</option>
    <option value="hard">Hard</option>
  </select>
  <button onclick="startGame()">New Game</button>
</div>

<div class="info">
  üí£ Mines: <span id="mines"></span> |
  üö© Flags left: <span id="flags"></span>
</div>

<div id="board" class="board"></div>

</main>

<script>
let rows, cols, mineCount, flagLimit;
let board = [];
let flagsLeft = 0;
let gameOver = false;

function startGame(){
  gameOver = false;

  const level = document.getElementById('level').value;
  if(level==="easy"){ rows=8; cols=8; mineCount=10; flagLimit=10; }
  if(level==="medium"){ rows=12; cols=12; mineCount=25; flagLimit=25; }
  if(level==="hard"){ rows=16; cols=16; mineCount=62; flagLimit=62; }

  flagsLeft = flagLimit;
  document.getElementById('mines').textContent = mineCount;
  document.getElementById('flags').textContent = flagsLeft;

  board=[];
  const boardEl=document.getElementById('board');
  boardEl.innerHTML='';
  boardEl.style.gridTemplateColumns=`repeat(${cols},36px)`;

  for(let i=0;i<rows*cols;i++){
    board.push({mine:false,open:false,flag:false,count:0});
  }

  let placed=0;
  while(placed<mineCount){
    let r=Math.floor(Math.random()*board.length);
    if(!board[r].mine){
      board[r].mine=true;
      placed++;
    }
  }

  for(let i=0;i<board.length;i++){
    if(board[i].mine) continue;
    let n=0;
    neighbors(i).forEach(j=>{ if(board[j].mine) n++; });
    board[i].count=n;
  }

  board.forEach((c,i)=>{
    const d=document.createElement('div');
    d.className='cell';

    d.addEventListener('click',()=>openCell(i));
    d.addEventListener('contextmenu',e=>{
      e.preventDefault();
      toggleFlag(i);
    });

    d.addEventListener('touchstart',e=>{
      d._t=Date.now();
      e.stopPropagation();
    });
    d.addEventListener('touchend',e=>{
      e.stopPropagation();
      if(Date.now()-d._t>500) toggleFlag(i);
      else openCell(i);
    });

    boardEl.appendChild(d);
  });
}

function neighbors(i){
  const res=[];
  const x=i%cols, y=Math.floor(i/cols);
  for(let dy=-1;dy<=1;dy++){
    for(let dx=-1;dx<=1;dx++){
      if(dx||dy){
        let nx=x+dx, ny=y+dy;
        if(nx>=0&&nx<cols&&ny>=0&&ny<rows){
          res.push(ny*cols+nx);
        }
      }
    }
  }
  return res;
}

function openCell(i){
  if(gameOver) return;
  const c=board[i];
  const el=document.getElementById('board').children[i];
  if(c.open||c.flag) return;

  c.open=true;
  el.classList.add('open');

  if(c.mine){
    explode(i);
    return;
  }

  if(c.count>0){
    el.textContent=c.count;
  }else{
    neighbors(i).forEach(openCell);
  }
}

function explode(hit){
  gameOver=true;
  board.forEach((c,i)=>{
    if(c.mine){
      const el=document.getElementById('board').children[i];
      el.classList.add('bomb');
      el.textContent='üí£';
    }
  });
  setTimeout(()=>alert('Game Over'),400);
}

function toggleFlag(i){
  if(gameOver) return;
  const c=board[i];
  const el=document.getElementById('board').children[i];
  if(c.open) return;

  if(!c.flag){
    if(flagsLeft===0) return;
    c.flag=true;
    el.textContent='üö©';
    el.classList.add('flag');
    flagsLeft--;
  }else{
    c.flag=false;
    el.textContent='';
    el.classList.remove('flag');
    // ‚ùó KEIN flagsLeft++
  }
  document.getElementById('flags').textContent=flagsLeft;
}

startGame();
</script>

</body>
  </html>
