<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Logic Music Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js"></script>
    <style>
        body { margin: 0; background: #0f0f0f; color: #00ff88; font-family: 'Courier New', Courier, monospace; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        #visualizer { width: 100px; height: 100px; border: 4px solid #00ff88; margin-bottom: 20px; transition: transform 0.1s; border-radius: 50%; }
        button { background: transparent; border: 2px solid #00ff88; color: #00ff88; padding: 15px 30px; font-size: 18px; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; }
        button:active { background: #00ff88; color: #0f0f0f; }
        #info { margin-top: 15px; font-size: 12px; color: #555; }
    </style>
</head>
<body>

    <div id="visualizer"></div>
    <button id="startBtn">Initialisiere Audio</button>
    <div id="info">Log: Warte auf User-Interaktion...</div>

    <script>
        let isStarted = false;
        const info = document.getElementById('info');
        const viz = document.getElementById('visualizer');

        // 1. Klangeinstellungen (Ein weicher Synth mit Echo)
        const delay = new Tone.FeedbackDelay("8n", 0.5).toDestination();
        const synth = new Tone.PolySynth(Tone.Synth).connect(delay);
        
        // Pentatonische Skala - klingt immer harmonisch
        const scale = ["C3", "D3", "E3", "G3", "A3", "C4", "D4", "E4", "G4", "A4"];

        // 2. Die Musik-Logik (Loop)
        const loop = new Tone.Loop(time => {
            // Zufällige Note wählen
            const note = scale[Math.floor(Math.random() * scale.length)];
            
            // Note spielen
            synth.triggerAttackRelease(note, "8n", time);
            
            // Visueller Effekt im Takt
            Tone.Draw.schedule(() => {
                viz.style.transform = "scale(1.2)";
                viz.style.backgroundColor = "#00ff88";
                info.innerText = "Log: Spiele " + note;
                setTimeout(() => { 
                    viz.style.transform = "scale(1.0)"; 
                    viz.style.backgroundColor = "transparent";
                }, 100);
            }, time);

        }, "4n");

        // 3. Der "RICHTIGE" Start-Mechanismus
        document.getElementById('startBtn').addEventListener('click', async () => {
            if (!isStarted) {
                // WICHTIG: Audio Kontext starten
                await Tone.start();
                await Tone.context.resume(); // Explizites Aufwecken für Mobilgeräte
                
                Tone.Transport.bpm.value = 120;
                Tone.Transport.start();
                loop.start(0);
                
                document.getElementById('startBtn').innerText = "STOP";
                isStarted = true;
                info.innerText = "Log: Audio läuft!";
            } else {
                Tone.Transport.stop();
                isStarted = false;
                document.getElementById('startBtn').innerText = "START";
                info.innerText = "Log: Pausiert.";
            }
        });
    </script>
</body>
</html>
