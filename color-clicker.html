<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Color Clicker</title>

  <!-- AdSense loader (optional) -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1154368264564805"
     crossorigin="anonymous"></script>

  <style>
    :root {
      --blue: #0b74de;
      --bg: #fff;
      --panel: #fafafa;
    }
    html,body{height:100%;margin:0;font-family:system-ui, -apple-system, "Segoe UI", Roboto, Arial;color:#111;background:#f5f7fb}
    /* Top bar */
    .topbar{
      background:var(--blue);
      color:#fff;
      height:56px;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      padding:0 12px;
      box-shadow:0 2px 6px rgba(11,115,222,0.06);
      font-weight:800;
      font-size:20px;
    }
    .home-link{
      position:absolute;
      left:12px;
      top:50%;
      transform:translateY(-50%);
      color:#fff;
      text-decoration:none;
      font-size:20px;
      opacity:0.6;
    }

    main{max-width:900px;margin:18px auto;padding:12px}
    .card{background:var(--panel);padding:16px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.06)}
    .controls{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:12px}
    .controls button{padding:8px 12px;border-radius:8px;border:1px solid #d0d7e0;background:#fff;font-weight:700;cursor:pointer}
    .status{margin-left:auto;font-weight:800}
    .grid{display:grid;grid-template-columns:repeat(2, 140px);gap:12px;justify-content:center;margin-top:12px}
    .cell{width:140px;height:140px;border-radius:12px;background:#e6e6e6;display:flex;align-items:center;justify-content:center;font-size:26px;cursor:pointer;user-select:none;transition:transform .08s ease}
    .cell:active{transform:scale(.98)}
    .cell.red{background:#ff6b6b;color:#fff}
    .cell.green{background:#28c76f;color:#fff}
    .cell.yellow{background:#ffca3a;color:#111}
    .cell.blue{background:#4dabf7;color:#fff}

    @media(max-width:480px){
      .grid{grid-template-columns:repeat(2, calc(40vw));gap:8px}
      .cell{width:40vw;height:40vw;font-size:20px}
    }
  </style>
</head>
<body>

  <!-- Top bar: home arrow left, ArcadeOwl centered -->
  <header class="topbar">
    <a class="home-link" href="/Game/index.html" aria-label="Home">←</a>
    <div>ArcadeOwl</div>
  </header>

  <main>
    <div class="card" role="application" aria-label="Color Clicker game">
      <div class="controls">
        <button id="startBtn">Start</button>
        <button id="restartBtn">Restart</button>
        <div>Time: <strong><span id="time">30</span>s</strong></div>
        <div>Score: <strong><span id="score">0</span></strong></div>
        <div class="status">Best: <span id="best">0</span></div>
      </div>

      <p style="margin:0 0 8px 0;color:#333">Click the highlighted box — it will only change after you click it.</p>

      <div class="grid" id="grid">
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
      </div>
    </div>
  </main>

  <script>
    (function(){
      const TIME_TOTAL = 30;
      const grid = document.getElementById('grid');
      const cells = Array.from(grid.querySelectorAll('.cell'));
      const timeEl = document.getElementById('time');
      const scoreEl = document.getElementById('score');
      const bestEl = document.getElementById('best');
      const startBtn = document.getElementById('startBtn');
      const restartBtn = document.getElementById('restartBtn');

      const BEST_KEY = 'color_clicker_best';
      bestEl.textContent = localStorage.getItem(BEST_KEY) || 0;

      let timer = null;
      let timeLeft = TIME_TOTAL;
      let score = 0;
      let activeIdx = -1;
      let running = false;

      function pickRandom() { return Math.floor(Math.random() * cells.length); }
      function randomColor() { return ['red','green','yellow','blue'][Math.floor(Math.random()*4)]; }

      function clearActive() {
        cells.forEach(c => c.classList.remove('red','green','yellow','blue','active'));
        activeIdx = -1;
      }

      // Activate one cell and keep it until clicked
      function activateRandom() {
        clearActive();
        activeIdx = pickRandom();
        const color = randomColor();
        const cell = cells[activeIdx];
        cell.classList.add(color, 'active');
      }

      function updateUI() {
        timeEl.textContent = timeLeft;
        scoreEl.textContent = score;
      }

      function startGame() {
        if (running) return;
        running = true;
        score = 0;
        timeLeft = TIME_TOTAL;
        updateUI();
        startBtn.disabled = true;
        restartBtn.disabled = false;
        activateRandom(); // show first highlighted cell
        timer = setInterval(() => {
          timeLeft--;
          updateUI();
          if (timeLeft <= 0) endGame();
        }, 1000);
      }

      function restartGame() {
        stopGame();
        score = 0;
        timeLeft = TIME_TOTAL;
        clearActive();
        updateUI();
        startBtn.disabled = false;
        restartBtn.disabled = false;
      }

      function stopGame() {
        running = false;
        clearInterval(timer);
        timer = null;
        clearActive();
      }

      function endGame() {
        stopGame();
        const best = parseInt(localStorage.getItem(BEST_KEY) || '0', 10);
        if (score > best) {
          localStorage.setItem(BEST_KEY, score);
          bestEl.textContent = score;
          alert('Time! New best: ' + score);
        } else {
          alert('Time! Your score: ' + score + '. Best: ' + best);
        }
      }

      // Click logic: only change the highlighted box AFTER the user clicks that highlighted box
      grid.addEventListener('click', (e) => {
        const cell = e.target.closest('.cell');
        if (!cell || !running) return;
        const idx = Number(cell.dataset.index);
        if (idx === activeIdx) {
          // correct click: increase score and pick a new active cell
          score += 1;
          scoreEl.textContent = score;
          activateRandom();
        } else {
          // wrong click: small penalty/feedback but do not change active box
          score = Math.max(0, score - 1);
          scoreEl.textContent = score;
          cell.style.transform = 'scale(.95)';
          setTimeout(()=> cell.style.transform = '', 90);
        }
      });

      startBtn.addEventListener('click', startGame);
      restartBtn.addEventListener('click', restartGame);

      // initialize
      updateUI();
      clearActive();
    })();
  </script>
</body>
  </html>
