<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Color Clicker</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; margin:0; padding:0; display:flex; flex-direction:column; min-height:100vh; }
    header, footer { background:#0b74de; color:#fff; padding:12px 16px; }
    header h1 { margin:0; font-size:20px; display:inline-block; }
    nav { margin-top:8px; }
    nav a { color:#fff; margin-right:10px; text-decoration:none; font-weight:600; font-size:14px; }
    main { flex:1; padding:20px; max-width:900px; margin:0 auto; }

    .card { background:#fafafa; border-radius:10px; padding:16px; box-shadow:0 4px 12px rgba(0,0,0,.06); }
    .controls { display:flex; gap:12px; align-items:center; flex-wrap:wrap; margin-bottom:12px; }
    .controls button { padding:8px 12px; border-radius:6px; border:1px solid #ccc; background:#fff; cursor:pointer; }
    .status { margin-left:auto; font-weight:700; }

    .grid { display:grid; grid-template-columns: repeat(2, 140px); gap:12px; justify-content:center; margin-top:12px; }
    .cell { width:140px; height:140px; border-radius:12px; display:flex; align-items:center; justify-content:center; background:#e6e6e6; font-size:26px; cursor:pointer; user-select:none; transition:transform .08s ease, box-shadow .08s; }
    .cell:active { transform:scale(.98); }
    .cell.active.red { background:#ff6b6b; color:#fff; }
    .cell.active.green { background:#28c76f; color:#fff; }
    .cell.active.yellow { background:#ffca3a; color:#111; }
    .cell.active.blue { background:#4dabf7; color:#fff; }

    @media (max-width:480px){
      .grid { grid-template-columns: repeat(2, calc(40vw)); gap:8px; }
      .cell { width:40vw; height:40vw; font-size:20px; }
    }
  </style>
</head>
<body>
  <header>
    <h1>Color Clicker</h1>
    <nav>
      <a href="/Game/index.html">Home</a>
      <a href="/Game/color-clicker.html">Color Clicker</a>
      <a href="/Game/emoji-memory.html">Emoji Memory</a>
      <a href="/Game/about.html">About</a>
      <a href="/Game/privacy.html">Privacy</a>
    </nav>
  </header>

  <main>
    <div class="card">
      <div class="controls">
        <button id="startBtn">Start</button>
        <button id="restartBtn">Restart</button>
        <div>Time: <strong><span id="time">30</span>s</strong></div>
        <div>Score: <strong><span id="score">0</span></strong></div>
        <div class="status">Best: <span id="best">0</span></div>
      </div>

      <div class="grid" id="grid">
        <div class="cell" data-index="0"></div>
        <div class="cell" data-index="1"></div>
        <div class="cell" data-index="2"></div>
        <div class="cell" data-index="3"></div>
      </div>

      <p style="margin-top:12px;color:#444">Click the highlighted box as fast as you can. Use <strong>Start</strong> to begin and <strong>Restart</strong> to reset.</p>
    </div>
  </main>

  <footer>
    <p>Â© My Games Site</p>
  </footer>

  <script>
    (function(){
      const TIME_TOTAL = 30;
      const grid = document.getElementById('grid');
      const cells = Array.from(grid.querySelectorAll('.cell'));
      const timeEl = document.getElementById('time');
      const scoreEl = document.getElementById('score');
      const bestEl = document.getElementById('best');
      const startBtn = document.getElementById('startBtn');
      const restartBtn = document.getElementById('restartBtn');

      const BEST_KEY = 'color_clicker_best';
      bestEl.textContent = localStorage.getItem(BEST_KEY) || 0;

      let timer = null;
      let timeLeft = TIME_TOTAL;
      let score = 0;
      let activeIdx = -1;
      let running = false;

      function pickRandom() { return Math.floor(Math.random() * cells.length); }
      function randomColor() {
        return ['red','green','yellow','blue'][Math.floor(Math.random()*4)];
      }

      function clearActive() {
        cells.forEach(c => c.classList.remove('active','red','green','yellow','blue'));
        activeIdx = -1;
      }

      function activateRandom() {
        clearActive();
        activeIdx = pickRandom();
        const cell = cells[activeIdx];
        const color = randomColor();
        cell.classList.add('active', color);
      }

      function updateUI() {
        timeEl.textContent = timeLeft;
        scoreEl.textContent = score;
      }

      function startGame() {
        if (running) return;
        running = true;
        score = 0;
        timeLeft = TIME_TOTAL;
        updateUI();
        startBtn.disabled = true;
        restartBtn.disabled = false;
        activateRandom();
        timer = setInterval(() => {
          timeLeft--;
          updateUI();
          if (timeLeft <= 0) endGame();
          else {
            // rotate target every 700ms for more action (but synced with interval will be each second)
          }
        }, 1000);
        // faster change than second: change target every 700ms independently
        if (!window._ccChangeInterval) {
          window._ccChangeInterval = setInterval(() => {
            if (running) activateRandom();
          }, 700);
        }
      }

      function restartGame() {
        stopGame();
        score = 0;
        timeLeft = TIME_TOTAL;
        clearActive();
        updateUI();
        startBtn.disabled = false;
        restartBtn.disabled = false;
      }

      function stopGame() {
        running = false;
        clearInterval(timer);
        timer = null;
        clearActive();
        startBtn.disabled = false;
      }

      function endGame() {
        stopGame();
        const best = parseInt(localStorage.getItem(BEST_KEY) || '0', 10);
        if (score > best) {
          localStorage.setItem(BEST_KEY, score);
          bestEl.textContent = score;
          alert('Time! New best: ' + score);
        } else {
          alert('Time! Your score: ' + score + '. Best: ' + best);
        }
      }

      // click logic only active when running
      grid.addEventListener('click', (e) => {
        const cell = e.target.closest('.cell');
        if (!cell || !running) return;
        const idx = Number(cell.dataset.index);
        if (idx === activeIdx) {
          score += 1;
          scoreEl.textContent = score;
          activateRandom();
        } else {
          // small penalty/feedback
          score = Math.max(0, score - 1);
          scoreEl.textContent = score;
          cell.style.transform = 'scale(.95)';
          setTimeout(()=> cell.style.transform = '', 90);
        }
      });

      startBtn.addEventListener('click', startGame);
      restartBtn.addEventListener('click', restartGame);

      // init
      updateUI();
      clearActive();
    })();
  </script>
</body>
</html>
